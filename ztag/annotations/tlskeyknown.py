from ztag.annotation import *

class TlsKeyKnownTag(Annotation):
    protocol = protocols.HTTPS
    subprotocol = protocols.HTTPS.TLS
    port = None

    FINGERPRINTS = set(['007fdaa8c08e250b5587ae9a49345a5c41e971cf3a52242670fc8bfb2e6d75ab',
                        '02980519c55e5dfb06656a7ea8ef7342553b6c95e4f9c5ea242b0f14398e4f90',
                        '03804c07a542330344396e92e4668bbb0bbefefa78ba6c74a80d9e3b3f219703',
                        '042faf6b5578ba4f33892e00e96836581acbd6e9dc03f9962f479fd1d6bd5445',
                        '06f29b4e6eac32323dfc372eff55150a901ea2ee1c287c50ef99856c786c072b',
                        '0b566c676bacfd62d1ae74bc3b8502a4405cd316d172b845ad3b4305c354dc8c',
                        '0e0505d9667e3da1a73ccf4264d1dae38223bc6ac159f66e2fb600c6a8f65299',
                        '0f1b486c96d6f1db6e5004a19482071ece5b8669069c8dd7f2239d8f732b6b72',
                        '10359839b1e49ba55951b3c41c2457f32c739c387bcf290af89e9600ca7755b7',
                        '121c838be8c0406a3ccd8dcaa7febf36331f43b7a709f207315b8c6844ef8375',
                        '12fe03e2d05700dce2a21300b89032c4bf329220d9e4dae8131bb31101bdbc09',
                        '132d2ce4d3a55c73aa5bf95c671e9c0e87f0ab9d3c34782dc8f9162fc713fc31',
                        '13657bfa2c9cdba7591f97675f203a8bad4ecbe3f70fbaccad43646dec3b600d',
                        '136c268a6680631acd46dcb643edd876f66525e8ba0e72561489812a490ed55d',
                        '1578652bc72b52439c4f24dcc7c13a7137e57111da899e5b63365792971b9c9d',
                        '167390050a67bb785bb01b0934bcc57b4865593ae98b2f09a002e496a69cebde',
                        '180b1952e696258fbfd5825142578ddb781e416974ae1405587d73c881fdf204',
                        '1819d09d4b9a024153abb4e4bb2db6aa45ef23f3b02281b9e1cecc659de1693e',
                        '182034cb65b46a7a8563262995120630392b1f5d626133d961503056c1c72c1a',
                        '1ac24caf29271e7e2847979a5a0f8908d7bce0a852c4407d5271b8a63afa081f',
                        '1d4aadf8925fd597951c60119ed33e88f4994548ffa72c92790b0fe7b2c2d0b6',
                        '1f2f8b736aa3886fee322ad5ab96e8adcfb7cdfbcb61e4bfbab140fbdaedf666',
                        '23756c87c3e65a4d09d07f5b0093b72a8ab5852b16bea95e80f293ca38e2ad61',
                        '263446e06f41e569590dd5eb224a7fe4e7b249ecd737f74a754b61f08842b974',
                        '268bcce65b4cfe7e15e3c9d2d60e1f325bf7e09ecad254f3acc44ec40ac9955f',
                        '276172c4901e1f69f7a4634e7ea7f2b034c87ffcbf02c884f0f24d55f9a77b64',
                        '27fdf2a38cd3b9dfe6c85e59178e661f059821e6ad8c506f50986088b2c129ad',
                        '2e61c214104f54bce5685cd10e46194cd3881a05f0214a3c88beb2945e33a50d',
                        '2ece680cbd0d58afdcc53156a629cdcdba02c4755195322e45cd101bbc14691c',
                        '2eff496179bc11ed1802526483e6eda3b8ca4a96af4054532811feb5f4e78d56',
                        '30ada332d9c6f9e10dda3e9b2a129e105637d8533eaa05f2484af14d212918cb',
                        '351747b9cbcf79aac5cb398a4734a8db87e4b6487998c32129366c326c08ce61',
                        '37d402b57b918992c5982462040a675a5fda023a5c60e63baca003bd11709aff',
                        '39f7ecde2160e664bf494f445a9fe5a70bcee5d04671dd62d33251bed4bb516c',
                        '3a275acd6477e509d94f74a911828c7925269bf904424ee992a623b176f139d6',
                        '3a681b04fcaf08e4151a09036ebb6e1375e8b0eb28bc31cfd3ee552f85aa0d31',
                        '3b08c01868b44a26427cc65074ddae2720cf975e39a2c5faa071dd0b25e842d1',
                        '3dbd6706ed5c8372a6b773417fe733f545c8589e16d2942de4465720e50900d0',
                        '3df297030ea4ab86a1e58d3455c729df700a574b37f4b8b0e1d5dc769e40fdb9',
                        '415ff4742721fd2888a33cd45c36d07dcc4794878ba229431439313674ed2dd1',
                        '42b85dd61894ea2a99bb8172603b3736776a8094a86d39de23deacdd273c0275',
                        '4403880b9cba3f740154a274418dc3435a5c1b57ca728b3387da568bacc803f1',
                        '464f4fcd90934c66b83509dffaa8993922520a7a14422853060a6a2c289d3ecb',
                        '465f11059ed20927060d03637a9f0c00759e2033007475541e2d302cb1042883',
                        '47fa89956f2aa349e8814b21a7bbd64c9b597f0f192bfe073559945a7a846534',
                        '51ab293c9fe391eeeb1a2739de15cd8029e3033142962c6c386f2da78d03a945',
                        '5228b5f98a23d3b34194ca76e0623dc84c906819a79611994159477191099af8',
                        '533424b1d73fa18c68a3849b792b7bbb596019d1fc2dc3e56a6fdad76fdb8798',
                        '53696bcf35c57934d624c2a0ae6233cadf86c367ef7b58ac660a92bd7c7e1dac',
                        '56c4f4cba93b12e9274e5e8b472a2a5535fbe5dbd92c94c051ffc06ed3dcbdbb',
                        '56e486049b2e98943759d2fe25fe24a4f2460c2e39e8761f8e3db9b250d3ed6a',
                        '5722d7cd625f59e0459a7f77825ec1b0222695d00a13c3767a4486b5014c44eb',
                        '5755a149dfc3f00e6d213bfdae18968148ca9b0991a2c192169b840be9d5a696',
                        '5b23e3d38d1a78b85f1d054818e5d0a91c06e3376bfffd389f60c22295b5240a',
                        '60a81c43e5a583d2b450ed96b7bd1309ff5441daca07ffedab3c619dc907bf06',
                        '60d00b3cfb5bb8a6d936bab40ef5c3c1970d3cd06dfddd09936e9527f6f2e68d',
                        '60da89d322a875d12cadee237478a53d83b60cd388c27f1311650534286e3e88',
                        '61d76d42946ac1e4f2c38172b103199b830c8b49ddedbe7ab7ba6ea38248b8e6',
                        '6612628da3f7134d4e21c7aff7cc0acefd709d35a12435480853cd79aab4c8b9',
                        '6655b3ddb55e3f37a6742ca25028444d2fd74a01b2545dcda879a68309448fd3',
                        '67cb6953df4dbc8a9bf28e49c790ced0f052d58053737247b6cb1f2a7bcebfee',
                        '68cc2ef42231142fef04dd701a9e9a4a39416f5c54d309e5e5203423256b97f4',
                        '6ad4ab39d3406b3c8fa6d6aef3450229232ddfb1752e4dbbdf76dbfdd82ced1a',
                        '6b4cf15ea316bb24fd37768eabf30cd9f069489f12db8710bcb5f399eace034b',
                        '6d6130e70257848ddb88436f54ec8f443d3d434927ce9c35cc92af7debf64837',
                        '6e8cad9bbca0c452ab851f9470bc56c4f0722df0e1b7ecc4c06b684fc8bf6793',
                        '719195c289c0e5361ab5952932085883eb0503bcc01738096684204ddaf48ccf',
                        '738523c7102fdd44124bb4a36075adfcb35dceb1f947ea56ea2366192d9e6482',
                        '73a335ea26dd43ed29032ed97287d41f993a62d639b8aaf111e77edbcd299ac0',
                        '76dedd416489a69368a5311bfc14ee3a24282e0a417b13852f61d9718dba4861',
                        '78fd13c7325a78b9600b589eef1cbca79d91fb93a50aa1e6339535aeb7c1c300',
                        '7a0cdfba4c3d30f005ab7545a7c9f2b70734be7f5246852254e53be9aee5cb48',
                        '7ada8534e11cb1f29930b5346f970803163013eff15bc838c9137d3d232f0f12',
                        '7bbcd8908a19345a69e1f0d420ace432e934121fdd45b0f8b72357eaddd18748',
                        '7fc0931794cd1ec2f414835c657992288d5e6f87aefacbc63e84daa4089830cd',
                        '7fee2d2c5f6ecc1f3ef58cbcbfb4e92b9b0c6f9d5aca0b0f2730f99ed3b6965c',
                        '816735d1fd53b8747aa3a61e277dd8fd5dd303475bc9730ead8ad67155518e33',
                        '860c614afc30fb91510f597281f05c8d1d18789ca084614b1daf7a7d7c9778d3',
                        '8b34030ee356195cafe3c12783a132280e1bded5d557f00c7c2b87703dbdf4f8',
                        '8cd058ff7e2204f05498ccdaa86560c61cb111bfc69e1682e82d0bdc21192cd8',
                        '8dfcdda83dfccb8e8441eae99f6fefc86740ce11ca259a16dff2929e87e3d801',
                        '8e14ac1b76bde6ba19d4ef1b3516b169e629b31bb94cec07bfc8c8b31438e3ee',
                        '8f65c15394371a53943783a9df43d4e2f47e28a7ce933465936e0b75f37fddb5',
                        '8ffa88876555864c22c79f12273aa4e97ade65a92876cf61991e66a0252d5d06',
                        '90d371553024736b91091d0b4db2670fcd7124d903c80588b5e11bf4f89ca948',
                        '90db9821efdaae7af64871f9096b1b2ad3f4ff65620b6f2574629a02f4f03ea8',
                        '939791981f2c5c4d99e13fc661b6d9a3404450cb50bcf1cfe5c1d38c4069dc38',
                        '94d4b664af7846fe3f715691f475fbcbb11c5a2b3762ee43b25edbdb86fc3c7f',
                        '954cf490a41b99387d90974723daba30038a5e4e448ba49d98699b91fd8a745d',
                        '96197cd06e4fc5ea57764cb79e85f34a5655f2e3426f70d06bebaa9f1093f407',
                        '991c0cd22a6df18fe6aff30ec0f59f90c23739c58adfe0ac747f13d0fdaa4228',
                        '9b86f11e961a7e435626c95375c0385ddabd700038d3e564c04963a97660db4f',
                        'a03b2079d382c9024a7b4c9fbbbd60e243fedd793f78b7b8027a82c4b2f599da',
                        'a04f3465bc3c57c4b7871b1dccd3a8b2215062fc1bb0b8f4ab173fdf4263f261',
                        'a4a6b5a448b04836953f2e42ed1d860353acf703c0f7ddbf194c5f834e896214',
                        'a6503f1151705e027b1c069689b99e314a0321ae65c9434e59d99ccfa087b9c7',
                        'a693b5952ba3c74033569a74f8b5460b0354d81db096c41669e16fa898a31ff2',
                        'a89075cd85ea68face4135b0df7f9a972e562b6ddbc3f05c713b5f400907527b',
                        'a8dc3a4b18b74fe962de4a4c5ff51c667b92f07ac1b7d04fd311c1c88939790c',
                        'a9e7b74d648e8ccaff46591483dfc645a72ef593e8fa00666464073757bedbf2',
                        'a9f036644c0b947b8f592e0769acba04ea2e277a512c6bd1f429997d16cfecb6',
                        'aa31d64400d3ef30e421dbbbc8fbe50b4319fe4fa28b27cb078ee240c4eeec93',
                        'aab25b16156139aca76b32b7aa2a7837e8439897b892741963963a8fe9f2bf96',
                        'ad49b195f050e72ea993472a06c38fdd9228812dfe6668d161b7fe64df8b0883',
                        'adcf87a27bf65ec6ef0d7863267741a736f2034a8a58cbdb5c5917077fe3795f',
                        'b116b6cc5d022fa5d609fb4b38239adae3487ed9f94b835fcd036643cb1590a9',
                        'b18fb98402028476926763d0e7da29bd545e3b84e5a36561792b77ad8f4e276b',
                        'b1993a3bf1456cea057a0753d5dc8cf6bfcb11d7a8ebaf8d4d1a39097b3bcc9e',
                        'b1cc105448e4e015cfd1a0caf1c1436773c7996ad8e6c8b3993a8afcaf25d4c0',
                        'b287a5e8d15b8b943fae1bc471661874c9dc8ff5cf1589ce1debc353223fd8d6',
                        'b43a2d6de1612df00e74e279906a5951757a5ebf849153e18517cc4acfac0b46',
                        'b73c50a2d3be3b9fba5e2e9e4c9cb86f98deb6b0a808d67fe8b0d2584dfb9600',
                        'b80bbb8d0fdd4d1a32515270abc19f0566ac13bc2f8603739237bfb266a88901',
                        'bc719c1e0ee3efc6745f080b1431d4c8c41517dc4ef6343540f84efeb20f6f21',
                        'bcafedfb57711f360cc998ac3733e752762c8bfb3b232adebf4c745c0b9eb982',
                        'bdc20333264aaf9030172ec3a611177edd15c13acea52cf4b28526e5e51244b5',
                        'c04a416c6c2317baebe286842fdcfb07a9b2ec929e77a076da3fc6c697757689',
                        'c2562c3b5dd60c3e73037e4f4d1ddadd86587d545e82fbde511a30998bcdff55',
                        'ca29d98eb8a83c1b2dee8e11befc8d83573b7fe636187e2ab1a70baba59eca99',
                        'ca7fee3f9a6fc0c9b67444940c7f344d5389803c040b1e21664dab18f776bd7d',
                        'cacec835b3b340b121982e92edc920927ac82c3821351b085ed8f2bc89a76ed9',
                        'cb36482dc97fe9dfafb4cc75d8f6bf2571a7c6d8bcc0716e6072c79576261f8a',
                        'cc6c74117c3849b49e4f9ccc451649b49ced4ad5075f4ff7f4fadb1d41ef34a1',
                        'cea5f4b8b3096e7ecb10b009a1d4ad0b0a2c7a8314cba9244c513cb2ca9e24eb',
                        'd1e0b01a2d6057e7d483d66697618e1050702b23445e1de0fb9305bc43fdf8dd',
                        'd28b07042ddd783f80485cf25ef5d08fec259cb3df2377f9c17d6e41bba2fdb5',
                        'd5c0101d5ac007024e50477188b03d76f28112472edf56c5e19a76cf069008e7',
                        'd736a2545de3821542a2d2d19415c3aaff2f62db9c84e5106f17ba4b15dbffc2',
                        'd7acc1eee3c33e40d805b8249ea505387dec1716120702922a63722d5f44019a',
                        'dbe28ce74a73d838169cce62ba8cd052fe9ab8badf1ccb6c7f8a224e1b7e0654',
                        'dc24d2c5cb9271083ec400dbac2210a7285fd5b09ba70b71ea5aaeeea4830ffe',
                        'dd7bb83d48709dc9064c742460cef928735cc6f446c2db0f5f1c4aba6cfba2dc',
                        'dd9c9d473cdcaec293e38462891209ce4c714efe7a0c2714975740043c1b4e83',
                        'dea7a4f4ed3493b1439ed20bd35e52fe493c2002e5ce00d94c09c538b401e0fd',
                        'dedff5f97a5b8a619d80791802efc85d75de042cc3d9eddb882826588c26d0ee',
                        'df9eea87e05c36648fd76b421d452704c87d5e0c046dd6efc458308e84017f55',
                        'e0178277c8d6720a54cc5e84e534e93722ef2cfa3337a34bf0319680155268b8',
                        'e254902ef38abfba260935095ac862fab3d530d49c2cbe98c78f7a74877026b7',
                        'e3e8069f9174ec82ffcaf320395df910ea1c2c58a9a9f943e8f22ee5384d7142',
                        'e4d09f84810efa9ad8541b7a820f094408ef760744ffe44d397f88d28b441995',
                        'e5190badcca6d5dbf7425180267926a8324fd79cad647b2ef4f8d9d3230f2216',
                        'e7948464af040bd95abafad04d4994d425e4a0e132bf6bc8e3a24ef986c6fc56',
                        'e98c65e8f67bbe8b4d72b076e5483e2e3d36598db1c77cfae3588c72cfe7aeec',
                        'f0602545e96ae10246571d480446283f0f16bc384f34af2858cb183bb32dc0e0',
                        'f3f0b000d320fcfa1fd315b5d8e929f667e4654bd61c43c589877b7741746b49',
                        'f4a73f510573f8398de96c4a6f047637c5e34e1883c55124e4ae5af5de2d934f',
                        'f6e432b5ad06200b051cfbc072b6c95b5421508d974c8b4b6e58cfac024513f5',
                        'f973624da2997470faaceeb7bffb20562a3b4abd3698ee87a0743e6f252c0779',
                        'fa4e09c8056cd10d36e6c03e5bb37e3f55e27dd346300aa95de0c7d706abe1b0',
                        'faebc680aece7e2fac8ab8f1970efc9b90cba64f91ad52dd19bd6e39cacc091c',
                        'fb64e0c2cb746211f9a4baec70c5610f51c47d52fa38007a1b9cc475bb2f4c6c',
                        'fcd10d720e85a956bc97aa4ed7f6b2915e8affb3ee1f1d32a2a2c9382c3c0df8',
                        'fcdae3841d10b6d18ebf758980a712b5de38819b308e2b2e20f49430f134d54b'])

    def process(self, obj, meta):
        s = obj["certificate"]["parsed"]
        if s["fingerprint_sha256"] in self.FINGERPRINTS:
            meta.tags.add("tls private key known")
            return meta
        return None